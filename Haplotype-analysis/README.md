## 单倍型分析

所谓的单倍型是指同一染色体上不同变异位点的各种线性组合形式。那么基因单倍型自然就是指同一基因上（启动子、外显子、内含子、终止子）的不同变异位点的显性组合形式。

### 基因型数据（必须）

既然单倍型分析需要变异位点信息，自然就需要基因型数据。基因型数据可以有很多来源，首先，可以零成本从各大公开数据库下载（推荐），其次，可以用一代测序的方法获取基因型数据（适合于基因不太长、样本数量较少的情况），如果你们课题组经费非常充足，可以自行做制作基因芯片、高通量测序等等。

- 一代测序数据：需要拼接成序列并保存成 fasta 格式
- 二代测序数据：VCF，Hapmap，plink（map&ped）
- 自定义格式：表格，每行为一个变异位点，每列为一个样品，前五列固定为 Chr，POS，REF，Alt 和 INFO

### 基因注释信息（可选）

如果需要查看单倍型中的变异位点在基因上面的分布的话，则会需要用到基因注释信息。如果没有这方面需求，则可以忽略。一般来说，各个已测序的物种都有对应的注释信息，这个做基因功能研究的肯定知道从哪里搞到适合你们所研究的物种的注释信息的。比如已测序的作物可以从 phytozome 数据库中下载，或者物种对应的数据库下载玉米（maizeGDB）。当然，这种注释信息不一定百分百正确。如果非常不行的你研究的基因恰巧注释是错误的，那么就需要你自行创建一个 BED 格式的注释文件了。

- GFF/GFF3：一般从数据库下载的注释文件属于这种格式，可以手动将对应基因的注释信息提取出来，也可以直接使用源文件
- BED6：一般自定义为 BED6 格式，第一列为染色体名称，第二列为起始位置，第三列为终止位置，第四列为片段名称（基因 ID+空格+CDS/UTR），第五列留空，第六列为方向（+/-）

### 样本信息（表型数据、地理坐标、样本分类等等，可选）

在分析完单倍型之后需要评估优势单倍型（产量高、高耐逆等）、变异位点的效应分析，则需要用到表型数据。单倍型的地理分布需要用到地理坐标。如果提供样本分类数据的话，单倍型网络分析能提供更多的线索。

- 文件中：每行为一个样本，每一列作为一种数据，
- R 中： 数据框（data.frame），行名为样本名，列名为数据信息（type，subgroup，location，等）